# 2025-10-05 12:05
---
mode: rule
ipv6: true
allow-lan: true
log-level: silent
tcp-concurrent: true
unified-delay: true
keep-alive-idle: 600
keep-alive-interval: 15
external-controller: 0.0.0.0:9090
secret: lh100172
bind-address: "*"
find-process-mode: 'off'
profile:
  store-selected: true
  store-fake-ip: true
  smart-collector-size: 100.0
lgbm-auto-update: true
lgbm-url: https://github.com/vernesong/mihomo/releases/download/LightGBM-Model/Model.bin
lgbm-update-interval: 72
geox-url:
  mmdb: https://testingcf.jsdelivr.net/gh/alecthw/mmdb_china_ip_list@release/lite/Country.mmdb
  geosite: https://testingcf.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat
sniffer:
  enable: true
  override-destination: true
  sniff:
    QUIC:
      ports:
        - 443
    TLS:
      ports:
        - 443
        - 8443
    HTTP:
      ports:
        - 80
        - 8080-8880
      override-destination: true
  force-domain:
    - "+.netflix.com"
    - "+.nflxvideo.net"
    - "+.media.max.com"
    - "+.media.dssott.com"
  skip-domain:
    - Mijia Cloud
    - dlg.io.mi.com
    - api.roonlabs.net
    - "+.apple.com"
    - "+.push.apple.com"
  parse-pure-ip: true
dns:
  enable: true
  ipv6: true
  cache-algorithm: arc
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist
  nameserver:
    - 211.136.192.6
    - 120.196.165.24
    - "[2409:8057:2000:2::8]:53"
    - "[2409:8057:2000:6::8]:53"
  fake-ip-filter:
    - "*.lan"
    - "*.localdomain"
    - "*.example"
    - "*.invalid"
    - "*.localhost"
    - "*.test"
    - "*.local"
    - "*.home.arpa"
    - "*.direct"
    - "+.yu0754.cn"
    - cable.auth.com
    - network-test.debian.org
    - detectportal.firefox.com
    - resolver1.opendns.com
    - global.turn.twilio.com
    - global.stun.twilio.com
    - app.yinxiang.com
    - injections.adguard.org
    - localhost.*.weixin.qq.com
    - "*.blzstatic.cn"
    - "*.cmpassport.com"
    - id6.me
    - open.e.189.cn
    - opencloud.wostore.cn
    - id.mail.wo.cn
    - mdn.open.wo.cn
    - hmrz.wo.cn
    - nishub1.10010.com
    - enrichgw.10010.com
    - "*.wosms.cn"
    - "*.jegotrip.com.cn"
    - "*.icitymobile.mobi"
    - "*.pingan.com.cn"
    - "*.cmbchina.com"
    - "*.10099.com.cn"
    - "*.microdone.cn"
    - PDC._msDCS.*.*
    - DC._msDCS.*.*
    - GC._msDCS.*.*
    - time.*.com
    - time.*.gov
    - time.*.edu.cn
    - time.*.apple.com
    - time-ios.apple.com
    - time1.*.com
    - time2.*.com
    - time3.*.com
    - time4.*.com
    - time5.*.com
    - time6.*.com
    - time7.*.com
    - ntp.*.com
    - ntp1.*.com
    - ntp2.*.com
    - ntp3.*.com
    - ntp4.*.com
    - ntp5.*.com
    - ntp6.*.com
    - ntp7.*.com
    - "*.time.edu.cn"
    - "*.ntp.org.cn"
    - "+.pool.ntp.org"
    - time1.cloud.tencent.com
    - music.163.com
    - "*.music.163.com"
    - "*.126.net"
    - musicapi.taihe.com
    - music.taihe.com
    - songsearch.kugou.com
    - trackercdn.kugou.com
    - "*.kuwo.cn"
    - api-jooxtt.sanook.com
    - api.joox.com
    - joox.com
    - y.qq.com
    - "*.y.qq.com"
    - streamoc.music.tc.qq.com
    - mobileoc.music.tc.qq.com
    - isure.stream.qqmusic.qq.com
    - dl.stream.qqmusic.qq.com
    - aqqmusic.tc.qq.com
    - amobile.music.tc.qq.com
    - "*.xiami.com"
    - "*.music.migu.cn"
    - music.migu.cn
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - localhost.ptlogin2.qq.com
    - localhost.sec.qq.com
    - "+.qq.com"
    - "+.tencent.com"
    - "+.srv.nintendo.net"
    - "*.n.n.srv.nintendo.net"
    - "+.cdn.nintendo.net"
    - "+.stun.playstation.net"
    - xbox.*.*.microsoft.com
    - "*.*.xboxlive.com"
    - xbox.*.microsoft.com
    - xnotify.xboxlive.com
    - "+.battle.net"
    - "+.battlenet.com.cn"
    - "+.wotgame.cn"
    - "+.wggames.cn"
    - "+.wowsgame.cn"
    - "+.wargaming.net"
    - proxy.golang.org
    - stun.*.*
    - stun.*.*.*
    - "+.stun.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*.*"
    - "+.stun.*.*.*.*.*"
    - heartbeat.belkin.com
    - "*.linksys.com"
    - "*.linksyssmartwifi.com"
    - "*.router.asus.com"
    - mesu.apple.com
    - swscan.apple.com
    - swquery.apple.com
    - swdownload.apple.com
    - swcdn.apple.com
    - swdist.apple.com
    - lens.l.google.com
    - stun.l.google.com
    - na.b.g-tun.com
    - "+.nflxvideo.net"
    - "*.square-enix.com"
    - "*.finalfantasyxiv.com"
    - "*.ffxiv.com"
    - "*.ff14.sdo.com"
    - ff.dorado.sdo.com
    - "*.mcdn.bilivideo.cn"
    - "+.media.dssott.com"
    - shark007.net
    - Mijia Cloud
    - "+.cmbchina.com"
    - "+.cmbimg.com"
    - local.adguard.org
    - "+.sandai.net"
    - "+.n0808.com"
    - "+.uu.163.com"
    - ps.res.netease.com
    - "+.pub.3gppnetwork.org"
proxy-providers:
  2022:
    type: http
    path: "./proxy_provider/2022"
    url: https://dler.cloud/subscribe/BrewSipsToken?protocols=ss2022&info=true&area=hk+tw+sg+us&provider=clash&match=AC|Max|Std|Pro|Ultra|Plus&nomatch=>
    interval: 28800
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
  Base:
    type: http
    path: "./proxy_provider/Base"
    url: https://dler.cloud/subscribe/BrewSipsToken?protocols=ss&info=true&provider=clash&match=AC.*>|Max.*>|Std.*>|Pro.*>|Ultra.*>|Plus.*>|BGP.*>
    interval: 28800
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
proxy-groups:
  - name: EndHK
    type: smart
    strategy: sticky-sessions
    policy-priority: Ultra|Plus:0.9;Pro:0.8;Std:0.7
    uselightgbm: true
    collectdata: true
    sample-rate: 1.0
    use:
      - 2022
    filter: '香港.*\]$'
  - name: EndTW
    type: smart
    strategy: sticky-sessions
    policy-priority: Ultra|Plus:0.9;Pro:0.8;Std:0.7
    uselightgbm: true
    collectdata: true
    sample-rate: 1.0
    use:
      - 2022
    filter: '台湾.*\]$'
  - name: EndSG
    type: smart
    strategy: sticky-sessions
    policy-priority: Ultra|Plus:0.9;Pro:0.8;Std:0.7
    uselightgbm: true
    collectdata: true
    sample-rate: 1.0
    use:
      - 2022
    filter: '新加坡.*\]$'
  - name: EndUS
    type: smart
    strategy: sticky-sessions
    policy-priority: Ultra|Plus:0.9;Pro:0.8;Std:0.7
    uselightgbm: true
    collectdata: true
    sample-rate: 1.0
    use:
      - 2022
    filter: '美国.*\]$'
  - name: RelayHK
    type: smart
    strategy: sticky-sessions
    policy-priority: Ultra|Plus:0.9;Pro:0.8;Std:0.7
    uselightgbm: true
    collectdata: true
    sample-rate: 1.0
    use:
      - Base
    filter: 'HKT'
  - name: RelayTW
    type: smart
    strategy: sticky-sessions
    policy-priority: Ultra|Plus:0.9;Pro:0.8;Std:0.7
    uselightgbm: true
    collectdata: true
    sample-rate: 1.0
    use:
      - Base
    filter: 'Edge|DMIT|HINET'
  - name: Proxy
    type: select
    proxies:
      - EndHK
      - EndTW
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: YouTube
    type: select
    proxies:
      - EndTW
      - EndHK
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: AppleTV
    type: select
    proxies:
      - EndTW
      - EndHK
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: Disney+
    type: select
    proxies:
      - EndTW
      - EndHK
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: Netflix
    type: select
    proxies:
      - EndTW
      - EndHK
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: HBOmax
    type: select
    proxies:
      - EndTW
      - EndHK
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: TikTok
    type: select
    proxies:
      - EndTW
      - EndHK
      - EndSG
      - EndUS
      - RelayHK
      - RelayTW
  - name: AiSuite
    type: select
    proxies:
      - RelayTW
      - RelayHK
      - EndHK
      - EndTW
      - EndSG
      - EndUS
rules:
  - Domain,dler.cloud,DIRECT
  - Rule-Set,BanAD,REJECT
  - Rule-Set,ManDC,DIRECT
  - Rule-Set,ManPC,Proxy
  - Rule-Set,EndHK,EndHK
  - Rule-Set,EndTW,EndTW
  - Rule-Set,EndSG,EndSG
  - Rule-Set,EndUS,EndUS
  - Rule-Set,RelayHK,RelayHK
  - Rule-Set,RelayTW,RelayTW
  - Rule-Set,YouTube,YouTube
  - Rule-Set,AppleTV,AppleTV
  - Rule-Set,Disney+,Disney+
  - Rule-Set,Netflix,Netflix
  - Rule-Set,HBOmax,HBOmax
  - Rule-Set,TikTok,TikTok
  - Rule-Set,AiSuite,AiSuite
  - Rule-Set,ChinaTLD,DIRECT
  - Rule-Set,GlobalPC,Proxy
  - Rule-Set,ChinaDN,DIRECT
  - Rule-Set,ChinaIP,DIRECT
  - Match,Proxy
rule-providers:
  BanAD:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/BanAD.txt
    path: "./rule_provider/BanAD"
    interval: 28800
  ManDC:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/ManDC.txt
    path: "./rule_provider/ManDC"
    interval: 28800
  ManPC:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/ManPC.txt
    path: "./rule_provider/ManPC"
    interval: 28800
  EndHK:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/EndHK.txt
    path: "./rule_provider/EndHK"
    interval: 28800
  EndTW:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/EndTW.txt
    path: "./rule_provider/EndTW"
    interval: 28800
  EndSG:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/EndSG.txt
    path: "./rule_provider/EndSG"
    interval: 28800
  EndUS:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/EndUS.txt
    path: "./rule_provider/EndUS"
    interval: 28800
  RelayHK:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/RelayHK.txt
    path: "./rule_provider/RelayHK"
    interval: 28800
  RelayTW:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/RelayTW.txt
    path: "./rule_provider/RelayTW"
    interval: 28800
  YouTube:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/YouTube.txt
    path: "./rule_provider/YouTube"
    interval: 28800
  AppleTV:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/AppleTV.txt
    path: "./rule_provider/AppleTV"
    interval: 28800
  Disney+:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/Disney+.txt
    path: "./rule_provider/Disney+"
    interval: 28800
  Netflix:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/Netflix.txt
    path: "./rule_provider/Netflix"
    interval: 28800
  HBOmax:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/HBOmax.txt
    path: "./rule_provider/HBOmax"
    interval: 28800
  TikTok:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/TikTok.txt
    path: "./rule_provider/TikTok"
    interval: 28800
  AiSuite:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/Select/AiSuite.txt
    path: "./rule_provider/AiSuite"
    interval: 28800
  ChinaTLD:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/System/ChinaTLD.txt
    path: "./rule_provider/ChinaTLD"
    interval: 28800
  GlobalPC:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/System/GlobalPC.txt
    path: "./rule_provider/GlobalPC"
    interval: 28800
  ChinaDN:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/System/ChinaDN.txt
    path: "./rule_provider/ChinaDN"
    interval: 28800
  ChinaIP:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/BrewSips/Clash/main/Rules/System/ChinaIP.txt
    path: "./rule_provider/ChinaIP"
    interval: 28800
